const input = [
  ".................#.#............................................#................#........................................#.......",
  ".....#.............................................................#.......#...#........................#...........#.......##....",
  "..........................................................#..#........#..........#...............#.#..................#...........",
  "..#...#..........#....#.....#......................................#......#..#............................#..#....................",
  ".........................#....#.............#....................................#............................................#...",
  ".....................#.......#.............#...#..........#.................#.......#...............#............#......#.........",
  "........#.........#.....................................#............#.....................##...#..#..........#...................",
  "....#...................#.....##......#............#...#........................#...................................#.............",
  "...............................................................................#.......#.....#...#................#.#......##.....",
  "..........................................#............................#.#.................................#.........#............",
  "........#...............#...............#...................##......#..................#...............#..........................",
  ".........................#....................................#..........#.........................................##.............",
  ".......#.................#..................................#......#....................#...............#..........#......#.......",
  ".............#.#...#.............#.............................................#...............................##.....#...#.......",
  ".....................................................#............................................#.........................#.....",
  ".#...#..........................................................##.................................#............#...............#.",
  "...........#..#........#.....#.............#.......#............................................#..............#.................#",
  "......#.#.##...............#.......#......#......................................................................#...............#",
  "...#........#.#.....................##...#...........................#..............................#...................#.........",
  "..............#..#....................#...................#.................##..............#.#........................#..........",
  "...........................................................#.........#.......................#......................#.........#...",
  "................................................#............................................#....................................",
  "..#.....................................................#..............#...#.........#.....#........................#.............",
  ".#..............................#......#..............#........................................................#..................",
  "#......#.....#..#..#........#....................#...........##..............................#..#.....#.....#.....................",
  ".................#.....#.....................#.........#..............................#..............##......................#....",
  "...........................................................#...##..............#..........................#....#..................",
  "........#..#............................#.#........................#.....#................#...#...................................",
  "..........................#........#.......................................................................##...................#.",
  "............#....#.............................................#.......#....#.....#........................................#......",
  "..........#............#....#.......................#.#............#..............................................................",
  "......#...#......................................................#..#.............................................................",
  ".#...#.....#.....#......................................................................................#..........#.....#........",
  "...#..#.............................................................................#.............................................",
  "............#...................#...........................................#..............#.....#.....................#.##.......",
  ".................................................#................................................................................",
  ".........................#.......................................#..................#..............................#..............",
  "................................................................................................................................#.",
  "...#...........................................#........#.................................................#......#................",
  "..#...........................................#.......#.....#.................................#....#.............#...............#",
  "........#..............#...................................................................................#......................",
  "...........#......#............#............#..................................#.........#..............#.........#..........#....",
  ".........................#.........#.....#.................................#..................#...............##..#...............",
  ".....#........#.........................................................#....................................#......#....#........",
  "...#..#.......#......#.#..................#..........................^#...........................................................",
  "....................#.#..........................................................................#...#............................",
  "...........................#..........................................................#...........................................",
  "................#..............................................................................#..................................",
  "...............................#............................................................#...................................#.",
  "..............#..........................................#..............#..................#..........#...........................",
  "................#...#..........................#.##..........#.......#..............................#........#..............#.....",
  "...................#.............#....................#...........................................................................",
  "....#....................................#....#................................................#..#...........#...................",
  "....#.#..............#..........#...................#...................................#....................#........#......#....",
  "...........................#...........#..#......#.......................................#.......................#......#.........",
  ".....................................................................................................#.................#..........",
  "...................................................#.............#..........#..............................#......................",
  "................................#...........##....................................................................#....#..........",
  "...........#.......#.......................................................................#............#.....................#...",
  ".#........#.......#........................................#.#...............................#...#...........................#....",
  "..#...............#................#....#............#................................................................#...........",
  "........#..........#.........#....................................................................................#...............",
  "............................................................................#.............................#...............#......#",
  "......................#................................#.............#...#............#...........................................",
  "................................#.............#.................................................................#..............#..",
  ".........#.#..#...............................#....................................................#.#.......#..#........#........",
  ".............................#.......#.....#......................................................#..#............................",
  "..................#.............................................................................#..........#......................",
  ".....................................#....##.................#......................................#....#........................",
  "#.......................................................................................................................#.........",
  "......#....#..#...........................#..#.....#........................................#..................................#..",
  ".......#.....#...............#....#......#....#..........#.....................#....#..........#.....#..#......................##.",
  "..................#..........#.....#........................................................#............##...................#...",
  "........................#....#............#..................................#....#..#.......#...................................#",
  ".....#............................#...............................#..#...................#.....#..#........#....#.#...............",
  "......#...#..#......#..........................#........#....................#.......#...........#..........................#..#..",
  ".....#.............................................................................................#......#......................#",
  "...........................................#......................................................................................",
  ".....#...........................#.#.#............................#..................#............................#.......#.......",
  "........#.......................................................#...................#.......#.....................................",
  "...............#..................................................#.................................................#.............",
  "..##............................................................#..............................................................#..",
  ".......#..................................#......................#.................................#...................#..........",
  "......#.........#..............#....##........#....#................................#.....................................#......#",
  "................#.....................................................................................#.............#.............",
  "#..#..#......#.#.....#..#.................................................................................................#..#....",
  ".....................#.....#................................................#.......#........#.................#........#.#...#...",
  "..................................................................#....#..#...................#................................#..",
  "........................#...........#.......................................................#..#..................................",
  ".#.......#...................................................#..............#.......#...#.........................................",
  ".......##...............#.............................#...........................#...............................................",
  "....#............#....#...#........................#...........................#.#.....#..........................................",
  "...........................#............................#..#..................#...........................#...#...................",
  "...........#.#.............#..........#...........................................................................................",
  ".............#..........#...............#...##.........................#..............#...#.............#..#......................",
  "..................#.....#............#..#.........#...............................................................................",
  "...........................................................#.....#..................#.......................#..#..................",
  "....................................#....#.......##............#.............................#...............#...........#........",
  "......#....................#..................#..........................................#...............................#.#......",
  "......................#...........................................#.....#.................................................#....#..",
  ".....................................#...............#....................................#.....#.............#......##...........",
  "......................#...............................................................##.#..........#....#..................#.....",
  "...........#.............#......................#....................#..................................#......#...........##.....",
  ".....#.#...#......................................................................................................................",
  ".........#.....................................#................#.............#....#......................#..........#............",
  "......##.#.................#...............#..##.......................#...............#.......................................#..",
  "....................#.........#.......#....#..................................#..........................#..............#.........",
  "......................#....#..#..#................................#.......#.......................................................",
  ".........................................##............................##..#..................#..................#...........#....",
  "...................#..................................#................................................................#..........",
  ".#.............#....................................................................................#.............................",
  "......................................#.....#.............#..#............................................#...#............#......",
  ".....................................#..................................#...#.......................##...................#........",
  "...........................................................#...................................................#...........#......",
  ".............................#.......#.......................................#.........................#.....................#...#",
  ".....................#............................................................................................................",
  "#....#.......................................#.........#........#...................................#.....#.........#........#....",
  ".......................................................#......#................................##.#........#.........#..........#.",
  ".........#........................##.....#.............................................................#.................#..#.....",
  "....##....................................................................................................#...#...#...............",
  ".......#.....#.......#.............#........#...............##.#......#...............#.................#..#.........#...#....#...",
  "....................#.................................#........................................................................#..",
  "#...............#....................................#.........#...............................#..#..........##...#...#......#....",
  "............#........................#.....#...#.........#.........#..#......................................#....................",
  "..........#.......#.#.....................#...........#...................#.##....................#..#...#........#..............#",
  ".......................................#.......#........#.....#...........................................#.......#......#........",
  "...............................#.........#..............#......................#..........................................#.#.....",
  "............#........#.............................................#.....................................................##......#",
  "......#.#............................................................................#......#.....#......#................#.......",
  ".........#.............#................#.................#..###..........#.........................#.#....#......................",
]

// const input = [
//   "....#.....",
//   ".........#",
//   "..........",
//   "..#.......",
//   ".......#..",
//   "..........",
//   ".#..^.....",
//   "........#.",
//   "#.........",
//   "......#...",
// ]

function main() {
  let visitedPositionsCount = 1;
  let currentPosition = findStartingPosition(input)
  let pointer = input[currentPosition[0]][currentPosition[1]];

  const visitedPositionsMap = {
    [currentPosition.join(" ")]: true
  }

  while (isInputInBounds(input, currentPosition)) {
    const nextPosition = getNextPosition(currentPosition, pointer)

    if (!isInputInBounds(input, nextPosition)) break;

    if (doesPositionCollide(input, nextPosition)) {
      pointer = rotatePointer(pointer)
      continue;
    }

    currentPosition = nextPosition;

    if (!visitedPositionsMap[currentPosition.join(" ")]) {
      visitedPositionsMap[currentPosition.join(" ")] = true;
      visitedPositionsCount += 1;
    }
  }

  console.log(visitedPositionsMap)

  return visitedPositionsCount;
}

function findStartingPosition(input) {
  for (let i = 0; i < input.length; i++) {
    for (let j = 0; j < input[i].length; j++) {
      if (["^", ">", "v", "<"].includes(input[i][j])) {
        return [i, j]
      }
    }
  }
}

function getNextPosition(currentPosition, pointer) {
  const nextPositionMap = {
    "^": [-1, 0],
    ">": [0, 1],
    "v": [1, 0],
    "<": [0, -1]
  }

  return [
    currentPosition[0] + nextPositionMap[pointer][0],
    currentPosition[1] + nextPositionMap[pointer][1]
  ]
}

function rotatePointer(pointer) {
  const rotationMap = {
    "^": ">",
    ">": "v",
    "v": "<",
    "<": "^"
  }
  
  return rotationMap[pointer]
}

function isInputInBounds(input, currentPosition) {
  return currentPosition[0] >= 0 && currentPosition[1] >= 0 && currentPosition[0] < input.length && currentPosition[1] < input[0].length
}

function doesPositionCollide(input, currentPosition) {
  return input[currentPosition[0]]?.[currentPosition[1]] === "#"
}

console.log(main())